<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basic Example · DispersiveShallowWater.jl</title><meta name="title" content="Basic Example · DispersiveShallowWater.jl"/><meta property="og:title" content="Basic Example · DispersiveShallowWater.jl"/><meta property="twitter:title" content="Basic Example · DispersiveShallowWater.jl"/><meta name="description" content="Documentation for DispersiveShallowWater.jl."/><meta property="og:description" content="Documentation for DispersiveShallowWater.jl."/><meta property="twitter:description" content="Documentation for DispersiveShallowWater.jl."/><meta property="og:url" content="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/basic_example/"/><meta property="twitter:url" content="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/basic_example/"/><link rel="canonical" href="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/basic_example/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="DispersiveShallowWater.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">DispersiveShallowWater.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../overview/">Overview</a></li><li class="is-active"><a class="tocitem" href>Basic Example</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#basic_example"><span>Getting started</span></a></li><li><a class="tocitem" href="#Define-physical-setup"><span>Define physical setup</span></a></li><li><a class="tocitem" href="#Define-numerical-solver"><span>Define numerical solver</span></a></li><li><a class="tocitem" href="#Solve-system-of-ordinary-differential-equations"><span>Solve system of ordinary differential equations</span></a></li><li><a class="tocitem" href="#visualize_results"><span>Visualize results</span></a></li><li><a class="tocitem" href="#More-examples"><span>More examples</span></a></li><li><a class="tocitem" href="#overview-plain-program"><span>Plain program</span></a></li></ul></li><li><a class="tocitem" href="../SBP_Operators/">Summation-by-Parts Operators</a></li><li><a class="tocitem" href="../dispersion/">Dispersion</a></li><li><a class="tocitem" href="../solvers/">Using Different Solvers</a></li><li><a class="tocitem" href="../callbacks/">Callbacks and Relaxation</a></li><li><a class="tocitem" href="../plotting/">Plotting</a></li><li><a class="tocitem" href="../dingemans/">Experimental Data</a></li><li><a class="tocitem" href="../development/">Development</a></li><li><a class="tocitem" href="../ref/">Reference</a></li><li><a class="tocitem" href="../changelog/">Changelog</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Basic Example</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Basic Example</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/main/docs/src/basic_example.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Basic-Example"><a class="docs-heading-anchor" href="#Basic-Example">Basic Example</a><a id="Basic-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Example" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>In this tutorial we describe how to numerically solve the BBM-BBM (Benjamin-Bona-Mahony) equations with variable bottom topography in one dimension. The equations describe a dispersive shallow water model, i.e. they extend the well-known shallow water equations in the sense that dispersion is modeled. The shallow water equations are a system of first order hyperbolic partial differential equations that can be written in the form of a balance law. In contrast, the BBM-BBM equations additionally include third-order mixed derivatives. In primitive variables <span>$q = (\eta, v)$</span> they can be written as:</p><p class="math-container">\[\begin{aligned}
  \eta_t + ((\eta + D)v)_x - \frac{1}{6}(D^2\eta_{xt})_x &amp;= 0,\\
  v_t + g\eta_x + \left(\frac{1}{2}v^2\right)_x - \frac{1}{6}(D^2v_t)_{xx} &amp;= 0.
\end{aligned}\]</p><p>All equations in <a href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl">DispersiveShallowWater.jl</a> follow the same variable conventions: <span>$\eta = h + b$</span> describes the total water height, <span>$h$</span> the water height above the bottom topography (bathymetry), <span>$b = \eta_0 - D$</span> the bathymetry, and <span>$v$</span> the velocity in horizontal direction. The reference water height <span>$\eta_0$</span> (also called still water height) and gravitational acceleration <span>$g$</span> are used consistently across all equations. For the BBM-BBM equations specifically, <span>$\eta_0$</span> is typically set to 0.</p><p>A sketch of the water height and bathymetry can be found below.</p><p><img src="../bathymetry.png" alt="water height and bathymetry"/></p><h2 id="basic_example"><a class="docs-heading-anchor" href="#basic_example">Getting started</a><a id="basic_example-1"></a><a class="docs-heading-anchor-permalink" href="#basic_example" title="Permalink"></a></h2><p>In order to conduct a numerical simulation with <a href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl">DispersiveShallowWater.jl</a>, we perform the following steps.</p><p>First, we load the necessary libraries:</p><pre><code class="language-julia hljs">using DispersiveShallowWater, OrdinaryDiffEqTsit5</code></pre><h2 id="Define-physical-setup"><a class="docs-heading-anchor" href="#Define-physical-setup">Define physical setup</a><a id="Define-physical-setup-1"></a><a class="docs-heading-anchor-permalink" href="#Define-physical-setup" title="Permalink"></a></h2><p>As a first step of a numerical simulation, we define the physical setup we want to solve. This includes the set of equations, potentially including physical parameters, initial and boundary conditions as well as the domain. In the following example, the initial condition describes a traveling wave that moves towards a beach, which is modeled by a linearly increasing bathymetry.</p><pre><code class="language-julia hljs">equations = BBMBBMEquations1D(bathymetry_type = bathymetry_variable, gravity = 9.81)

function initial_condition_shoaling(x, t, equations::BBMBBMEquations1D, mesh)
    A = 0.07 # amplitude of wave
    x0 = -30 # initial center
    eta = A * exp(-0.1*(x - x0)^2)
    v = 0
    D = x &lt;= 0.0 ? 0.7 : 0.7 - 1/50 * x
    return SVector(eta, v, D)
end

initial_condition = initial_condition_shoaling
boundary_conditions = boundary_condition_periodic

coordinates_min = -130.0
coordinates_max = 20.0
N = 512
mesh = Mesh1D(coordinates_min, coordinates_max, N)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Mesh1D{Float64} 
    xmin: -130.0
    xmax: 20.0
    N: 512</code></pre><p>The first line specifies that we want to solve the BBM-BBM equations with variable bathymetry using a gravitational acceleration of <span>$g = 9.81$</span>. Afterwards, we define the initial condition, which is described as a function with the spatial variable <code>x</code>, the time <code>t</code>, the <code>equations</code>, and a <code>mesh</code> as parameters.</p><p>If an analytical solution is available, the time variable <code>t</code> can be used, and the initial condition can serve as an analytical solution to be compared with the numerical solution. Otherwise, you can just keep the time variable unused.</p><p>An initial condition in <a href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl">DispersiveShallowWater.jl</a> is supposed to return an <code>SVector</code> holding the values for each of the unknown variables. Since the bathymetry is treated as a variable (with time derivative 0) for convenience, we need to provide the value for the primitive variables <code>eta</code> and <code>v</code> as well as for <code>D</code>.</p><p>Next, we choose periodic boundary conditions. <a href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl">DispersiveShallowWater.jl</a> also supports reflecting boundary conditions for some but not all equations. For more information see the <a href="../overview/#eq_overview">Dispersive Shallow Water Models overview</a>.</p><p>Lastly, we define the physical domain as the interval from -130 to 20 and we choose 512 nodes. The node distribution of the mesh depends on the chosen SBP operators. For classical finite difference operators this is homogeneous, i.e. the distance between consecutive nodes is constant. We choose the left boundary very far to the left in order to avoid interactions between left- and right-traveling waves. This prevents unwanted wave interference that could occur when waves wrap around due to the periodic boundary conditions.</p><h2 id="Define-numerical-solver"><a class="docs-heading-anchor" href="#Define-numerical-solver">Define numerical solver</a><a id="Define-numerical-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Define-numerical-solver" title="Permalink"></a></h2><p>In the next step, we build a <a href="../ref/#Semidiscretization"><code>Semidiscretization</code></a> that bundles all ingredients for the spatial discretization of the model. Especially, we need to define a <a href="../ref/#Solver"><code>Solver</code></a>.</p><p>The simplest way to define a solver when working with <a href="../ref/#DispersiveShallowWater.boundary_condition_periodic"><code>boundary_condition_periodic</code></a> is to call the constructor by providing the mesh and a desired order of accuracy.</p><p>In the following example, we use an accuracy order of 4. The default constructor simply creates periodic first-, second-, and third-derivative central finite difference summation-by-parts (SBP) operators of the provided order of accuracy.</p><p>How to use other summation-by-parts operators, is described in the section on <a href="../solvers/#customize_solver">how to customize the solver</a>. Note that for non-periodic boundary conditions, the solver also needs to be created with non-periodic operators, see, e.g. <a href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/main/examples/bbm_bbm_1d/bbm_bbm_1d_basic_reflecting.jl">examples/bbm_bbm_1d/bbm_bbm_1d_basic_reflecting.jl</a>.</p><pre><code class="language-julia hljs">accuracy_order = 4
solver = Solver(mesh, accuracy_order)

semi = Semidiscretization(mesh, equations, initial_condition, solver, boundary_conditions = boundary_conditions)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Semidiscretization
    #spatial dimensions: 1
    mesh: Mesh1D{Float64} with length 512
    equations: BBMBBMEquations1D-BathymetryVariable
    initial condition: initial_condition_shoaling
    boundary condition: boundary_condition_periodic
    source terms: nothing</code></pre><p>Finally, we put the <code>mesh</code>, the <code>equations</code>, the <code>initial_condition</code>, the <code>solver</code>, and the <code>boundary_conditions</code> together in a semidiscretization <code>semi</code>.</p><h2 id="Solve-system-of-ordinary-differential-equations"><a class="docs-heading-anchor" href="#Solve-system-of-ordinary-differential-equations">Solve system of ordinary differential equations</a><a id="Solve-system-of-ordinary-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Solve-system-of-ordinary-differential-equations" title="Permalink"></a></h2><p>Once we have obtained a semidiscretization, we can solve the resulting system of ordinary differential equations. To do so, we specify the time interval that we want to simulate and obtain an <code>ODEProblem</code> from the <a href="https://diffeq.sciml.ai/latest/">SciML ecosystem for ordinary differential equations</a> by calling <a href="../ref/#SummationByPartsOperators.semidiscretize-Tuple{Semidiscretization, Any}"><code>semidiscretize</code></a> on the semidiscretization and the time span.</p><p>Finally, the <code>ode</code> can be <code>solve</code>d using the interface from <a href="https://github.com/SciML/OrdinaryDiffEq.jl">OrdinaryDiffEq.jl</a>. This means we can specify a time-stepping scheme we want to use, the tolerances for the adaptive time-stepping, and the time values, where the solution values should be saved. In this case, we use the adaptive explicit Runge-Kutta method <code>Tsit5</code> by Tsitouras of order 5(4), which is implemented in the subpackage OrdinaryDiffEqTsit5.jl. If you want to use other time-stepping schemes, you can install the respective subpackage or the whole package OrdinaryDiffEq.jl, which will install every available solver. Here, we save the solution at 100 equidistant points in time.</p><pre><code class="language-julia hljs">tspan = (0.0, 25.0)
ode = semidiscretize(semi, tspan)

saveat = range(tspan..., length = 100)
sol = solve(ode, Tsit5(), abstol = 1e-7, reltol = 1e-7, saveat = saveat)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: 1st order linear
t: 100-element Vector{Float64}:
  0.0
  0.25252525252525254
  0.5050505050505051
  0.7575757575757576
  1.0101010101010102
  1.2626262626262625
  1.5151515151515151
  1.7676767676767677
  2.0202020202020203
  2.272727272727273
  ⋮
 22.97979797979798
 23.232323232323232
 23.484848484848484
 23.737373737373737
 23.98989898989899
 24.242424242424242
 24.494949494949495
 24.747474747474747
 25.0
u: 100-element Vector{RecursiveArrayTools.ArrayPartition{Float64, Tuple{Vector{Float64}, Vector{Float64}, Vector{Float64}}}}:
 ([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  4.18977566412085e-98, 2.634314754138311e-99, 1.628131203594956e-100, 9.89135926907869e-102, 5.907005757043003e-103, 3.467557353096705e-104, 2.0008970917724163e-105, 1.1349342285125057e-106, 6.3279272320138276e-108, 3.468143826672347e-109], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ([-3.410080069062542e-55, 3.4668743503234934e-55, -1.3090064176156726e-55, 1.0025300960799842e-55, -4.757498968353704e-56, 3.0626692240918517e-56, -1.6138872992105767e-56, 9.6861942372402e-57, -5.331415158072675e-57, 3.1090176401488343e-57  …  -8.172133884846469e-51, 3.209889347693682e-51, -1.2479652523398732e-51, 4.801569597139102e-52, -1.827841438909224e-52, 6.88276450772701e-53, -2.562540742085072e-53, 9.415119417221164e-54, -3.4006533581907066e-54, 9.454465284107732e-55], [9.52268446544951e-56, 2.1278513006166136e-58, 5.234204805317849e-56, 1.8503165954219038e-57, 1.500418845706539e-56, -1.0896992430965072e-57, 3.908489642146348e-57, -8.225066327344084e-58, 1.0548289523278774e-57, -3.59370566341488e-58  …  5.732188802249994e-51, -2.3221265639822285e-51, 9.313552591445699e-52, -3.697616813627177e-52, 1.452836951061929e-52, -5.648334483652439e-53, 2.172937666691345e-53, -8.26702305417592e-54, 3.2308638806557745e-54, -1.136183283935388e-54], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ([-3.0141351599508478e-52, 2.9905649937505424e-52, -1.1479051138859063e-52, 8.771505223929902e-53, -4.152915036284489e-53, 2.706288735623505e-53, -1.413304342081326e-53, 8.60566472090083e-54, -4.697768772595504e-54, 2.7727216461334957e-54  …  -5.913791414269682e-48, 2.3624172668528777e-48, -9.345969129283597e-49, 3.660888423427924e-49, -1.4195677208091054e-49, 5.447950932824295e-50, -2.0684134649352234e-50, 7.752542271400614e-51, -2.859799614435081e-51, 8.176982986833403e-52], [1.1876496416666931e-52, -1.225333368617287e-54, 6.3648964562198875e-53, 1.6038600873512598e-54, 1.8461479384225662e-53, -1.4204825789545115e-54, 4.9127987317608226e-54, -1.0090547826905682e-54, 1.3494198053317912e-54, -4.409095530484176e-55  …  5.869903771251974e-48, -2.415259078686617e-48, 9.843902631706886e-49, -3.973391605582212e-49, 1.5880510885224857e-49, -6.283534727695071e-50, 2.4616372841364286e-50, -9.541452006257526e-51, 3.803886169955636e-51, -1.362624332063479e-51], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ([-5.791496332073667e-50, 5.617351771649272e-50, -2.1901680807725476e-50, 1.670185272522865e-50, -7.893533111422173e-51, 5.202427218277534e-51, -2.694897187331375e-51, 1.6635788483844398e-51, -9.010734593433566e-52, 5.382044160744357e-52  …  -9.358818632982434e-46, 3.8012576439330974e-46, -1.5296990353498949e-46, 6.097891327283467e-47, -2.4075017957514544e-47, 9.411747391833334e-48, -3.641788243762429e-48, 1.3914994418552543e-48, -5.238594569410369e-49, 1.5387889556354652e-49], [2.7710398648799335e-50, -6.257870171054511e-52, 1.4502252275373862e-50, 2.1738250419069716e-52, 4.256448419668542e-51, -3.4646223386547714e-52, 1.1561735740233069e-51, -2.323669826843604e-52, 3.2300956375937934e-52, -1.014264437339151e-52  …  1.1278390042047734e-45, -4.713678578597475e-46, 1.9522326442544944e-46, -8.011002222596533e-47, 3.2564931974786763e-47, -1.3111564191312937e-47, 5.2296634596706295e-48, -2.0645564895474437e-48, 8.393148413544395e-49, -3.061417145995649e-49], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ([-4.869296482433299e-48, 4.6273607019994037e-48, -1.830338059166326e-48, 1.3933331981973074e-48, -6.576873331881297e-49, 4.378877091643725e-49, -2.252333205918419e-49, 1.4079873727948625e-49, -7.572156656585556e-50, 4.574360109348898e-50  …  -6.558368217491507e-44, 2.706235494520067e-44, -1.1068143733212871e-44, 4.485902277537804e-45, -1.801409941518189e-45, 7.16585690816774e-46, -2.8225677777205333e-46, 1.0980736006315555e-46, -4.2133032409022794e-47, 1.2690340853887003e-47], [2.654423216199653e-48, -9.03824637989478e-50, 1.3599643567241786e-48, 7.068976931584119e-51, 4.036955250686432e-49, -3.462685757269755e-50, 1.117433191582672e-49, -2.2049603100942343e-50, 3.171143893422182e-50, -9.605132121019777e-51  …  8.999732343557072e-44, -3.8179202687650177e-44, 1.6056262759014022e-44, -6.692853142615695e-45, 2.7647511195853142e-45, -1.1316585398134097e-45, 4.5908442072234404e-46, -1.843868013132656e-46, 7.63450268125574e-47, -2.8321346730530116e-47], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ([-2.477034543447518e-46, 2.3082595634649213e-46, -9.26024948011573e-47, 7.037862078909478e-47, -3.319329835327241e-47, 2.2315612917904427e-47, -1.140388031811103e-47, 7.217229340920214e-48, -3.8546366556033916e-48, 2.3555413313641597e-48  …  -2.783732360353224e-42, 1.1669742210355194e-42, -4.850564158944296e-43, 1.9987113292011635e-43, -8.163194349578968e-44, 3.3039119816691664e-44, -1.3246084723413748e-44, 5.246013541218131e-45, -2.0512590484090816e-45, 6.333596256508299e-46], [1.4951701939444337e-46, -6.8163066517128e-48, 7.505606822990352e-47, -3.6638233006906375e-49, 2.2540028417812047e-47, -2.0376374373229782e-48, 6.356464212883665e-48, -1.2339625346441576e-48, 1.8322116597028455e-48, -5.3587619239186705e-49  …  4.221286240910586e-42, -1.8179916340083692e-42, 7.764498699918256e-43, -3.28808211707809e-43, 1.3804227690488552e-43, -5.744627304898446e-44, 2.370428912797271e-44, -9.68642308259316e-45, 4.0848380790525684e-45, -1.541147287859832e-45], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ([-8.642274153515123e-45, 7.907218020405483e-45, -3.215451975388564e-45, 2.4401891384528197e-45, -1.1504493174591306e-45, 7.804591578915143e-46, -3.965251249149693e-46, 2.539150947635366e-46, -1.3473041134956278e-46, 8.327099918723522e-47  …  -8.146598230471202e-41, 3.468398446796706e-41, -1.4646101567020161e-41, 6.133192965441342e-42, -2.5465478421825746e-42, 1.048149361350906e-42, -4.275023202174057e-43, 1.7226170922047868e-43, -6.859972506396881e-44, 2.1694996577631163e-44], [5.659736518654396e-45, -3.2160808712749437e-46, 2.7878481277724018e-45, -4.156854238315146e-47, 8.468989741740119e-46, -8.055669579550168e-47, 2.4312412270987167e-46, -4.655121469210561e-47, 7.113733676101086e-47, -2.0135380676995311e-47  …  1.3373818299221835e-40, -5.845705324048887e-41, 2.534735890796254e-41, -1.0901360997593376e-41, 4.649596306950078e-42, -1.9664359990545744e-42, 8.249777646514759e-43, -3.4281899765038638e-43, 1.4716261223051902e-43, -5.643811676137893e-44], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ([-2.2469886429571418e-43, 2.0209193156986254e-43, -8.325609752706091e-44, 6.309878885795459e-44, -2.974941540696895e-44, 2.0352650002721686e-44, -1.0287256920210411e-44, 6.661701693370457e-45, -3.513116259242675e-45, 2.195665710120345e-45  …  -1.7853779791358105e-39, 7.717244846910317e-40, -3.309502461980808e-40, 1.4078781188540196e-40, -5.94023129904958e-41, 2.4853066069931724e-41, -1.0307190096375447e-41, 4.223483447252227e-42, -1.7120289611379395e-42, 5.54138023490642e-43], [1.5744291177713832e-43, -1.0674303105460937e-44, 7.620069554819225e-44, -1.897745157872476e-45, 2.3413700186232573e-44, -2.3399299022144163e-45, 6.837245533578983e-45, -1.2943848991929825e-45, 2.0297298067216033e-45, -5.5718453013562964e-46  …  3.1287392149039615e-39, -1.3875767082159606e-39, 6.106615942473933e-40, -2.6664042391190154e-40, 1.1549682069707338e-40, -4.962283258196184e-41, 2.1157310736710312e-41, -8.936536971529584e-42, 3.903016134192307e-42, -1.5207919276627306e-42], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ([-4.628925173799488e-42, 4.096437014777423e-42, -1.7090212398312493e-42, 1.2936757172470616e-42, -6.101924025501135e-43, 4.2077295071057275e-43, -2.1170718161531046e-43, 1.3857990085684003e-43, -7.265820871965116e-44, 4.591502966297537e-44  …  -3.1107542678632613e-38, 1.364934986620581e-38, -5.943099094152075e-39, 2.567689646807546e-39, -1.1006030410725007e-39, 4.6792328834816915e-40, -1.972566679910436e-40, 8.216326713453772e-41, -3.388881873121604e-41, 1.121980641350675e-41], [3.4363987730589335e-42, -2.7010060799585277e-43, 1.6360743974698564e-42, -5.71428467510089e-44, 5.084460211910786e-43, -5.332960703438406e-44, 1.5094464319204317e-43, -2.831882534868173e-44, 4.544611085431558e-44, -1.2122261127634375e-44  …  5.763391430676492e-38, -2.592495596007782e-38, 1.1578645411383618e-38, -5.131675706207443e-39, 2.2568818849521135e-39, -9.84808718509565e-40, 4.265982955175089e-40, -1.8309203705591968e-40, 8.132690718162355e-41, -3.2184136446460253e-41], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ([-7.85791583061979e-41, 6.848296250647119e-41, -2.8924289100827757e-41, 2.187035399621741e-41, -1.0324014725964897e-41, 7.172580720828963e-42, -3.594229704446101e-42, 2.377329767562052e-42, -1.2396180868527358e-42, 7.919952954657637e-43  …  -4.476663921574045e-37, 1.9943192100981152e-37, -8.813924517453034e-38, 3.8669401310027113e-38, -1.6834892492941236e-38, 7.27143465982008e-39, -3.11504529186647e-39, 1.3185598429305148e-39, -5.532133707032003e-40, 1.8726450830760794e-40], [6.135795821433867e-41, -5.4793816601400876e-42, 2.876582310247162e-41, -1.2953319043098265e-42, 9.041769271251612e-42, -9.94558263130266e-43, 2.727643156902585e-42, -5.082567946420797e-43, 8.32662589058863e-43, -2.161972196352546e-43  …  8.712763857552121e-37, -3.970803936607558e-37, 1.8003008244233765e-37, -8.096302239521116e-38, 3.61485759341773e-38, -1.6016867284498053e-38, 7.047575339421402e-39, -3.072735458885269e-39, 1.387707658521198e-39, -5.576064296128315e-40], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ⋮
 ([-0.002177430631429416, -0.0010965639972228124, -0.0005868797227388575, 0.00072619929627179, 5.831128633754283e-6, -1.827119256640651e-5, 0.0016102571812587493, 0.0029140530217995537, 0.003075505627288965, 0.006582530888452397  …  -0.0022365881491008257, -0.0034362779550864975, -0.0015886772320027097, -0.003050865367045247, -0.002755257083274828, -0.002137951647940636, -0.0025230282665501132, -0.0024432676828162843, -0.0016176141359683293, -0.0024056509346186], [-0.005466733379849158, -0.002982707536617302, -0.0016715018904771316, -0.0028544103013873495, 0.0008811251707776218, 0.004193769560856117, 0.0040083157006247806, 0.008621015937998747, 0.01642261774470241, 0.01834059233052479  …  0.013622840421340862, 0.005385594375546395, 0.009799079309055334, 0.00032544904637000994, -0.0026304289361218803, -0.0042604231766303945, -0.011963428538217104, -0.016349647990346754, -0.01354320885391551, -0.015416613311115747], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ([-0.002509752769726096, -0.0018219245529320152, -0.001214376916430495, -0.0004377128351242018, -0.0013903050167783362, -0.0006366364027965257, 0.0003624031361002702, 9.592526835881426e-5, 0.0008002644109002725, 0.0032186478250469247  …  -0.0007546651509170756, -0.0024595025539814025, -0.0012442743852893422, -0.0011405080536935994, -0.0017703774560601658, -0.0011864226039569083, -0.0009363609832375471, -0.0021817271407894305, -0.0019235845023911334, -0.002236750757296506], [-0.00849785917143564, -0.0080537178001576, -0.006699153450290495, -0.004877717091639931, -0.00016327857959363607, -0.0011060485788323597, -0.0028032995483737674, 0.0017408774683962411, 0.005072257065011551, 0.007550016473428372  …  0.014932572303312608, 0.00508853905330595, 0.006589974354297351, 0.003566994017630922, -0.004295441195460152, -0.006660473445040747, -0.009320268420450856, -0.015977776274176757, -0.013387273203767657, -0.014646037285410151], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ([-0.0018665093733562998, -0.002110364962880299, -0.002014791068011246, -0.0018796985422312733, -0.002104263614908173, -0.0005318922963624734, -0.0005645496861407784, -0.0013744378676770282, -0.0003914230563880103, 0.0003907601421350973  …  -0.0002473232807358665, -0.0008227867879425262, -0.0009488266122126854, 7.572121468113579e-5, -0.00013611215128147303, -0.0007434959940722821, -0.00020290406305318608, -0.0014173912353600679, -0.001927643819772864, -0.0015077950913583134], [-0.008812149209150653, -0.009902846581768187, -0.009034699228643066, -0.0059775126276504845, -0.0027482908536222914, -0.005442771453382359, -0.004713999341883124, -0.0014298996632693337, -0.0025562891716506067, -0.00027990667612970714  …  0.01259014458870085, 0.007169540498582729, 0.0022811205547870568, 0.002732122615881989, -0.0026245003075737803, -0.008233080630074484, -0.005737592424272576, -0.009986616729745114, -0.012892514289240794, -0.013891552201664647], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ([-0.00113589449886617, -0.0019781433781777095, -0.0024002351250667505, -0.0027158583142074108, -0.0022227876764123965, -0.0007723502908222212, -0.0016060053726093802, -0.0016919916648021154, -0.0007302445322457804, -0.0012931104241188775  …  -0.0002795023348046695, 0.0006145242708864924, 5.516120070988113e-5, 0.0003787360131528878, 0.0010480374006435562, -0.00025823105279256393, -0.0003005805335872318, -0.0003386364312135011, -0.0011600806985225653, -0.0008920663649517172], [-0.0065322778144580144, -0.007634520754391197, -0.00818006948420798, -0.0070640359264060705, -0.0071101750838992, -0.008614728803233721, -0.004365629702325714, -0.0032022541473988838, -0.005983801745166056, -0.0037602195266694103  …  0.0071425078986337, 0.007534899124577207, 0.0008669698068636209, -0.0010494643263576227, 0.000277317939573613, -0.00509247658465647, -0.003919754368684934, -0.004563715007848193, -0.011433373745762884, -0.012883896246472619], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ([-0.000852194819405119, -0.0015147477475260874, -0.001940456531978288, -0.0023995484892647525, -0.0019208164142741023, -0.0016043227933443943, -0.0025961150923486296, -0.0014930536633282587, -0.0009632843706364103, -0.0019265352727884542  …  1.3184734502079875e-5, 0.0010888559916508586, 0.0013320756810936997, 0.0004094178149173828, 0.001059274821010214, 0.0004988570764762831, -0.00021599681611689678, 0.0004895297794952313, -0.00013354126505438492, -0.0006564738073425161], [-0.003570316010159579, -0.003837014736900782, -0.0056486048122823, -0.007411798188826787, -0.010085148817497485, -0.009458736423355856, -0.004557996532626617, -0.005829064466890154, -0.006776194859385267, -0.004276481885915872  …  0.002572348468325243, 0.004037231940953362, 0.0025220291766913515, -0.0024155302216638287, 0.0015396225481105954, 0.0004650623136454592, -0.003582398982782256, -0.0032025555670946618, -0.007812621216967533, -0.009530264748267507], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ([-0.0007943683921754092, -0.000915496459242495, -0.0009385904424276834, -0.0013287583172306512, -0.0014196774266011277, -0.002351374113933043, -0.0028928841852685146, -0.0013217540764752767, -0.0016138583382056919, -0.0020111802595053642  …  0.0008372101162813661, 0.0007875939003279269, 0.0017770308704650303, 0.0007762946557753114, 0.0005303687337447365, 0.0011963216982577326, 0.0005128459279157911, 0.0007108173835115737, 0.00037111087740853137, -0.0005200949183681874], [-0.0017189331149374406, -0.0015792774152628033, -0.003410528495736109, -0.006031854970357405, -0.008910945894681166, -0.007489703732301882, -0.006004440049429293, -0.009003340903689955, -0.006680334326624139, -0.00455798070832131  …  0.0013109207266094615, -0.00046842774884671537, 0.0038908354221417383, 0.000831339321865365, 0.0007449333066840106, 0.002990975111517117, -0.002606512818496778, -0.003208712441614928, -0.002714110685682673, -0.004160055088640814], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ([-0.0005064984086977025, -0.00039496415574883417, -0.0001292861715617973, -0.0004069844669697687, -0.0009064769998671377, -0.002225686597950349, -0.0021207784514334664, -0.001327280105954403, -0.002449744840016119, -0.0019116838903699763  …  0.0014044591984505752, 0.0005011193429013649, 0.001102605773471542, 0.0013373179554890234, 0.0005478555744551944, 0.0014039277431591522, 0.001213365395280193, 0.0005327425948217931, 0.0002982345325354773, -0.00014893050339001348], [-0.0010597124827860947, -0.001377673767153077, -0.002198771504734106, -0.003215216540552546, -0.004384341771723047, -0.003994168219134203, -0.007213399790091536, -0.01017493293102407, -0.00627464915692505, -0.006149806244612211  …  0.0016067414968939909, -0.0017013206313197626, 0.002414615814258579, 0.004474530457316246, -0.0001553160857431121, 0.0014177703715015663, 0.00011352218216565202, -0.0007873383090594133, 0.0014625684664392189, 0.0005256692041666195], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ([7.754526643375604e-5, -4.84763351793545e-5, 8.580018970130916e-5, -0.00013841188480221607, -0.00047634496215577494, -0.0011901075665505505, -0.0007107908952202078, -0.0013428192211170382, -0.002704217430162711, -0.0016315967035741956  …  0.0009565348324083455, 0.000622040121166541, 0.000249615295374516, 0.0014883574922715409, 0.0011389229626873418, 0.0010938070566713345, 0.0011599579563898918, 0.00044777392116848014, 0.0002077113043007574, 0.0003884847993050329], [-0.0004312657495644633, -0.0014022988777077543, -0.0013793941662275098, -0.0004974124210769081, -7.805627572575023e-5, -0.0011777924993705143, -0.006371260865465193, -0.007455761229577547, -0.005255791500433723, -0.008131443383921553  …  0.00019873146569357778, 0.00020852445107247735, -0.000883083859770224, 0.0035555816196626675, 0.0003900740287342044, 2.549562491906974e-5, 0.0033175210742067925, 0.0033949978518557607, 0.0031197001675751968, 0.0027715605305900577], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])
 ([0.0006085997267897991, 0.00017963947090796577, -2.732746882715572e-5, -0.00025123487377857383, -0.0001352497084124664, -1.781093526290565e-6, 0.00038912086785494444, -0.0011589969700970346, -0.0018721716478997622, -0.0010725227079491962  …  -0.00013196965971175583, 0.0007843734243317732, 0.00013024842423955678, 0.0009624224179967668, 0.0013127942563921206, 0.0006290637972320285, 0.0005865057460646276, 0.0006555025599581107, 0.0004290733923409661, 0.0007349266742613062], [0.0008867225111887661, -8.966666585793677e-5, -0.00015105826430804453, 0.0008443044775136842, 0.0012822495343986107, -0.00024774304586978754, -0.003329536864935172, -0.002061331253180985, -0.0035683035527065052, -0.008225482989418522  …  -0.0033626207293173446, 0.0008219447577883043, -0.0031292341308551026, -0.0008625255545709002, 0.001731001895821947, 0.001760358415569405, 0.004762964926671294, 0.0057283547979376835, 0.0030680988919196224, 0.003322417269725734], [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.35859374999999993, 0.35273437499999993, 0.34687499999999993, 0.34101562499999993, 0.33515624999999993, 0.32929687499999993, 0.32343749999999993, 0.31757812499999993, 0.31171874999999993, 0.30585937499999993])</code></pre><p>After solving the equations, <code>sol</code> contains the solution for each of the—in this case—three variables at every spatial point for each of the 100 points in time.</p><h2 id="visualize_results"><a class="docs-heading-anchor" href="#visualize_results">Visualize results</a><a id="visualize_results-1"></a><a class="docs-heading-anchor-permalink" href="#visualize_results" title="Permalink"></a></h2><p>After running the simulation, the results can be visualized using <a href="https://github.com/JuliaPlots/Plots.jl">Plots.jl</a>, which needs to be imported first. Then, we can plot the solution at the final time by calling <code>plot</code> on a <code>Pair</code> of the <code>Semidiscretization</code> and the corresponding <code>ODESolution</code> <code>sol</code>. The result is depicted in the following picture.</p><pre><code class="language-julia hljs">using Plots, Printf
plot(semi =&gt; sol, plot_title = @sprintf &quot;BBM-BBM equations at t = %.2f&quot; last(tspan))</code></pre><p><img src="../shoaling_solution.png" alt="shoaling solution"/></p><p>By default, this will plot the bathymetry, but neither the initial nor the analytical solution.</p><p>You can adjust this by passing the boolean values <code>plot_bathymetry</code> (if <code>true</code>, always plot bathymetry in the first subplot), <code>plot_initial</code>, and <code>plot_analytical</code>. Note that <code>plot_analytical = true</code> will evaluate and plot the initial condition function at the same time <code>t</code> as the numerical solution being displayed (the final time by default). This means if your initial condition function represents an analytical solution, setting <code>plot_analytical = true</code> will plot the analytical solution at that specific time for comparison. On the other hand, <code>plot_initial = true</code> will always plot the initial condition at time <code>t = first(tspan)</code>.</p><p>Plotting an animation over time can, e.g., be done by the following command, which uses <code>step</code> to plot the solution at a specific time step. Here <code>conversion = waterheight_total</code> makes it so that we only look at the total water height <span>$\eta$</span> and not also the velocity <span>$v$</span>. More on tutorials for plotting can be found in the chapter <a href="../plotting/#plotting">Plotting Simulation Results</a>.</p><pre><code class="language-julia hljs">anim = @animate for step in 1:length(sol.u)
    plot(semi =&gt; sol, plot_initial = true, conversion = waterheight_total, step = step, xlims = (-50, 20), ylims = (-0.8, 0.1),
         plot_title = @sprintf &quot;BBM-BBM equations at t = %.2f&quot; sol.t[step])
end
gif(anim, &quot;shoaling_solution.gif&quot;, fps = 25)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr36"><span class="sgr1">[ Info: </span></span>Saved animation to /home/runner/work/DispersiveShallowWater.jl/DispersiveShallowWater.jl/docs/build/shoaling_solution.gif</code></pre><p><img src="../shoaling_solution.gif" alt="shoaling solution"/></p><p>It is also possible to plot the solution variables at a fixed spatial point over time by calling <code>plot(semi =&gt; sol, x)</code> for some <code>x</code>-value, see the chapter <a href="../plotting/#plotting">Plotting Simulation Results</a> in this documentation for some examples.</p><h2 id="More-examples"><a class="docs-heading-anchor" href="#More-examples">More examples</a><a id="More-examples-1"></a><a class="docs-heading-anchor-permalink" href="#More-examples" title="Permalink"></a></h2><p>More examples sorted by the simulated equations can be found in the <a href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/tree/main/examples">examples/</a> subdirectory.</p><h2 id="overview-plain-program"><a class="docs-heading-anchor" href="#overview-plain-program">Plain program</a><a id="overview-plain-program-1"></a><a class="docs-heading-anchor-permalink" href="#overview-plain-program" title="Permalink"></a></h2><p>Here follows a version of the program without any comments.</p><pre><code class="language-Julia hljs">using DispersiveShallowWater, OrdinaryDiffEqTsit5

equations = BBMBBMEquations1D(bathymetry_type = bathymetry_variable, gravity = 9.81)

function initial_condition_shoaling(x, t, equations::BBMBBMEquations1D, mesh)
    A = 0.07 # amplitude of wave
    x0 = -30 # initial center
    eta = A * exp(-0.1*(x - x0)^2)
    v = 0
    D = x &lt;= 0.0 ? 0.7 : 0.7 - 1/50 * x
    return SVector(eta, v, D)
end

initial_condition = initial_condition_shoaling
boundary_conditions = boundary_condition_periodic

coordinates_min = -130.0
coordinates_max = 20.0
N = 512
mesh = Mesh1D(coordinates_min, coordinates_max, N)

solver = Solver(mesh, 4)

semi = Semidiscretization(mesh, equations, initial_condition, solver, boundary_conditions = boundary_conditions)

tspan = (0.0, 25.0)
ode = semidiscretize(semi, tspan)

saveat = range(tspan..., length = 100)
sol = solve(ode, Tsit5(), abstol = 1e-7, reltol = 1e-7, saveat = saveat)

using Plots
plot(semi =&gt; sol)

anim = @animate for step in 1:length(sol.u)
    plot(semi =&gt; sol, plot_initial = true, conversion = waterheight_total, step = step, xlims = (-50, 20), ylims = (-0.8, 0.1),
         plot_title = @sprintf &quot;BBM-BBM equations at t = %.2f&quot; sol.t[step])
end
gif(anim, &quot;shoaling_solution.gif&quot;, fps = 25)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../overview/">« Overview</a><a class="docs-footer-nextpage" href="../SBP_Operators/">Summation-by-Parts Operators »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.17.0 on <span class="colophon-date" title="Sunday 1 March 2026 14:51">Sunday 1 March 2026</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
